# API 管理平台 PRD

版本：v1.0

日期：2026-02-03

负责人：待定

状态：草案

---

**文档目的**：定义 API 管理平台的产品范围、功能需求、流程与验收标准，为设计、研发与测试提供统一依据。

---

## 1. 背景与目标

**背景**：团队在 API 调试、测试、文档协作上依赖多工具切换，接口信息源分散且易过期，需要统一入口与标准化流程。

**目标**：构建一个集 API 调试、测试、文档于一体的协作平台，数据来源仅依赖 IDEA 的 easy-yapi 插件推送，实现同步即用、文档即见、测试可复用。

**关键原则**：
- 唯一数据源：仅支持 IDEA easy-yapi 插件推送同步，不支持手动配置接口
- 同步即使用：调试、测试、文档、Mock 均基于同步数据生成
- 面向协作：支持团队权限、日志审计与分享
- 不可手动编辑接口字段：接口字段完全来自同步数据，仅允许展示与引用

---

## 2. 产品范围

**范围内**：
- easy-yapi 推送数据接收与解析
- 接口、分类同步与版本更新
- API 调试与环境管理
- API 测试、测试套件与报告
- Mock 服务
- 在线文档、分享与导出
- 团队协作与权限
- 用户与项目管理

**范围外**：
- 手动录入或编辑接口定义
- 手动编辑接口字段与 Schema
- 直接对接非 easy-yapi 的接口管理系统或其他数据源
- CI/CD 集成与自动化发布

---

## 3. 用户与场景

**用户角色**：
- 后端开发：关注接口变更、联调效率
- 前端开发：关注文档与调试体验
- 测试工程师：关注用例编排、执行与报告
- 项目负责人：关注权限、协作与审计

**关键场景**：
- 接口更新后自动同步并触发文档更新
- 前端在测试环境调试接口并保存历史请求
- 测试工程师基于接口定义创建用例并批量执行
- 项目负责人对外分享文档并控制权限

---

## 4. 术语与定义

- easy-yapi：IDEA 插件，从代码生成接口数据并推送到平台
- 推送：easy-yapi 将接口数据发送到平台的机制
- 接口定义：路径、方法、参数、请求体、响应体等元数据
- Mock：基于接口 Schema 自动生成或自定义响应

---

## 5. 成功指标

- 同步成功率 ≥ 99.9%
- 同步延迟 ≤ 5 秒可见
- 调试请求复用率 ≥ 30%
- 文档访问转化率（访问后产生调试或测试）≥ 20%

---

## 6. 功能结构分层

- 第一层：easy-yapi 数据同步层
- 第二层：API 调试层
- 第三层：API 测试层
- 第四层：Mock 服务层
- 第五层：文档层
- 第六层：AI 辅助层
- 第七层：团队协作层
- 第八层：用户与项目管理层
- 第九层：系统设置层

---

## 7. 功能需求明细

### 7.1 easy-yapi 数据同步层

| 功能点 | 说明 | 优先级 |
| --- | --- | --- |
| 推送接收 | 接收 easy-yapi 推送的接口数据 | P0 |
| 数据解析 | 解析接口数据结构与 Schema | P0 |
| 接口同步 | 新增、更新、删除接口 | P0 |
| 分类同步 | 同步接口分类和项目分组 | P0 |
| 同步日志 | 记录成功、失败及错误详情 | P0 |
| 同步状态展示 | 展示最后同步时间与差异对比 | P1 |
| 手动触发同步 | 支持全量推送一次（需 easy-yapi 配合） | P1 |

### 7.2 API 调试层

| 功能点 | 说明 | 优先级 |
| --- | --- | --- |
| 接口列表 | 按分类展示同步的接口 | P0 |
| 接口详情 | 展示接口定义详情 | P0 |
| 字段只读 | 接口字段仅展示，不支持手动编辑 | P0 |
| 请求发送 | 基于接口定义发起请求 | P0 |
| 环境管理 | 多环境切换，变量管理 | P0 |
| 前置/后置脚本 | 请求前预处理、响应后处理 | P1 |
| Cookie 管理 | 自动 Cookie 持久化 | P1 |
| 请求历史 | 历史请求记录与复用 | P1 |
| 收藏功能 | 常用接口收藏 | P1 |

### 7.3 API 测试层

| 功能点 | 说明 | 优先级 |
| --- | --- | --- |
| 测试用例 | 基于接口创建测试用例 | P0 |
| 测试套件 | 用例集合与批量执行 | P0 |
| 断言验证 | 状态码、响应体、响应头、耗时 | P0 |
| 数据驱动 | 参数化与多数据测试 | P1 |
| 测试报告 | 通过率、错误详情、执行日志 | P1 |
| 性能测试 | 并发与压力测试 | P2 |

### 7.4 Mock 服务层

| 功能点 | 说明 | 优先级 |
| --- | --- | --- |
| Mock 规则 | 根据 Schema 自动生成 | P0 |
| Mock 服务 | 内网或公网 Mock 地址 | P0 |
| 自定义 Mock | 模板或脚本自定义返回 | P1 |
| Mock 期望 | 基于请求参数返回不同数据 | P1 |

### 7.5 文档层

| 功能点 | 说明 | 优先级 |
| --- | --- | --- |
| 在线文档 | 基于同步数据生成 | P0 |
| 文档分享 | 公开、私有链接与权限控制 | P0 |
| 文档导出 | Markdown、HTML、Word、PDF | P1 |
| 文档搜索 | 全文搜索与快速定位 | P1 |
| 代码示例 | 多语言请求示例生成 | P1 |
| 字段树状展示 | 请求与响应字段以树状结构展示 | P0 |

### 7.6 AI 辅助层

| 功能点 | 说明 | 优先级 |
| --- | --- | --- |
| AI 生成用例 | 基于接口自动生成测试用例 | P1 |
| AI 生成数据 | 自动生成测试数据 | P1 |
| AI 参数命名 | 智能命名建议 | P2 |
| AI 规范检测 | 文档完整性检查与建议 | P1 |

### 7.7 团队协作层

| 功能点 | 说明 | 优先级 |
| --- | --- | --- |
| 成员管理 | 角色权限与成员邀请 | P0 |
| 操作日志 | 审计与变更追溯 | P1 |
| 评论与讨论 | 接口评论与提醒 | P2 |

### 7.8 用户与项目管理层

| 功能点 | 说明 | 优先级 |
| --- | --- | --- |
| 用户认证 | 登录、注册、Token | P0 |
| 项目管理 | 创建项目并绑定 easy-yapi 推送项目标识 | P0 |
| easy-yapi 配置 | 配置推送地址、Token/密钥、项目标识 | P0 |
| 个人中心 | 个人信息与 Token 管理 | P1 |

### 7.9 系统设置层

| 功能点 | 说明 | 优先级 |
| --- | --- | --- |
| 主题设置 | 亮色与暗色 | P2 |
| 界面布局 | 自定义工作区布局 | P2 |
| 快捷键 | 自定义快捷键 | P2 |

---

## 8. 关键流程

**接口同步流程**：
- IDEA easy-yapi 插件触发推送
- 平台接收推送并验签
- 解析接口数据
- 写入或更新接口与分类
- 记录同步日志并刷新文档

**调试流程**：
- 选择项目与环境
- 进入接口详情
- 自动填充参数与示例
- 发送请求并保存历史

**测试流程**：
- 选择接口生成用例
- 设置断言与数据驱动
- 加入测试套件并执行
- 输出报告与结果统计

**文档发布流程**：
- 接口同步成功
- 文档自动更新
- 生成分享链接与权限配置

**Mock 流程**：
- 自动生成 Mock 规则
- 可选自定义模板
- 提供 Mock URL

---

## 9. 权限与角色

| 角色 | 权限范围 |
| --- | --- |
| Owner | 项目全权限，人员管理与配置 |
| Admin | 接口、测试、文档、Mock、成员管理 |
| Editor | 调试、测试、文档操作 |
| Viewer | 只读访问 |

---

## 10. 数据模型概览

- Project：项目、绑定 easy-yapi 配置
- Category：接口分类
- Interface：接口定义、请求与响应 Schema
- SyncLog：同步状态、错误信息、差异信息
- Environment：环境变量与全局变量
- RequestHistory：请求记录
- TestCase：测试用例、断言、参数化
- TestSuite：用例集合、执行记录
- TestReport：执行结果与指标
- MockRule：自动或自定义 Mock
- DocShare：分享链接与权限
- User：用户资料与角色
- Token：访问令牌

---

## 11. 非功能性需求

- 性能：接口同步完成后 5 秒内可见更新
- 稳定性：推送接收成功率 99.9%
- 安全：推送验签、Token 认证、权限隔离
- 可用性：支持主流浏览器和移动端响应式
- 审计：关键操作日志可追溯

---

## 12. 验收标准

- 支持 easy-yapi 推送的接口新增、更新、删除
- 同步成功后，文档与接口列表在 5 秒内更新
- 调试请求支持环境变量、请求历史、基础断言
- 测试套件支持批量执行并产出报告
- Mock 规则可自动生成并提供 URL
- 分享文档支持公开与私有两种模式
- 接口字段为只读，不支持手动编辑
- 文档请求与响应字段以树状结构展示

---

## 13. 里程碑

| 阶段 | 功能范围 | 目标 |
| --- | --- | --- |
| MVP | 推送接收、接口同步、调试、文档 | 基础可用 |
| V1.0 | 测试用例、环境管理、团队协作、Mock | 团队可用 |
| V2.0 | AI 辅助、高级测试、性能测试 | 智能升级 |

---

## 14. 风险与依赖

- 依赖：easy-yapi 推送稳定性与数据结构
- 风险：接口变更频繁导致同步压力增加
- 风险：不支持手动配置带来的理解成本
- 依赖：Mock 与测试引擎的性能与可扩展性

---

## 15. 未决问题

- 推送验签方式是否统一为 HMAC
- 全量推送的触发频率与权限
- Mock 服务对公网访问的安全策略

---

## 16. 附录

### 16.1 easy-yapi 推送事件类型（以实际协议为准）

| 事件类型 | 说明 |
| --- | --- |
| interface.add | 新增接口 |
| interface.update | 更新接口 |
| interface.delete | 删除接口 |

### 16.2 接口数据结构示例（以 easy-yapi 推送协议为准）

```json
{
  "event": "interface.update",
  "data": {
    "id": "接口ID",
    "name": "接口名称",
    "path": "接口路径",
    "method": "请求方法",
    "title": "接口标题",
    "status": "接口状态",
    "req_params": "路径参数",
    "req_query": "查询参数",
    "req_headers": "请求头",
    "req_body_type": "请求体类型",
    "req_body_other": "请求体定义",
    "res_body": "响应体定义",
    "catid": "分类ID"
  }
}
```

### 16.3 参考链接

- https://apifox.com
- https://apifox.com/blog/
- https://spec.openapis.org/oas/latest.html
